# 搭建 Flutter 开发环境

> 开发环境推荐 MAC: 便于 IOS 的开发

> 参考[官网](https://flutterchina.club/get-started/install/)根据具体项目进行操作

## 一、 安装 flutter

### 1.1 使用镜像: 添加环境变量

根据当前所使用的 shell 编辑 `.zshrc` 或者 `.bashrc`, 添加以下内容

```sh
export PUB_HOSTED_URL=https://pub.flutter-io.cn
export FLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cn

# 重新加载配置
source .zshrc
```

### 1.2 下载 Flutter SDK

1. 进入 [flutter 官网](https://flutter.dev/docs/development/tools/sdk/releases?tab=linux#macos) 下载 Linux 最新可用的安装包, 进入版本列表点击 `Version` 链接即可下载对应版本的 `SDK`

2. 解压安装包到你想安装的目录, 比如: ~/Flutter/flutter

3. 添加 flutter 相关工具到 path 中

根据当前所使用的 shell 编辑 `.zshrc` 或者 `.bashrc`, 添加以下内容

```sh
export PATH=~/Flutter/flutter/bin:$PATH
# 重新加载配置
source .zshrc
```

### 1.3 运行 flutter doctor 测试是否成功安装 flutter

如下显示已正确安装 Flutter, 其中 Flutter 中默认安装了 Dart

```sh
flutter doctor

[✓] Flutter (Channel stable, v1.12.13+hotfix.9, on Linux, locale zh_CN.UTF-8)
[✗] Android toolchain - develop for Android devices
    ✗ ANDROID_HOME = /home/linheng/Flutter/Android
      but Android SDK not found at this location.
[!] Android Studio (not installed)
[!] VS Code (version 1.43.2)
    ✗ Flutter extension not installed; install from
      https://marketplace.visualstudio.com/items?itemName=Dart-Code.flutter
[!] Connected device
    ! No devices available

! Doctor found issues in 4 categories.

```

## 二、 配置 Android

### 2.1 配置环境变量

根据当前所使用的 shell 编辑 `.zshrc` 或者 `.bashrc`, 添加以下内容

```sh
# 配置 android_sdk 存储目录
export ANDROID_HOME=~/Flutter/Android

# 重新加载配置
source .zshrc
```

### 2.2 下载安装 Android Studio

[Android Studio](https://developer.android.google.cn/studio/)

3. 安装: 解压下载文件到一个自定目录(这个目录就是软件安装目录): 这里我放在 `~/Flutter/android-studio`

4. 进入 `android-studio/bin` 目录, 执行 `studio.sh`

5. 安装过程中会询问一下几个问题:

- import Android Studio Settings ... : 是否导出旧的 Android 配置, 这里默认即可
- Unable to access Android SDK add-on list: 第一次运行提示无法加载 SDK 列表, 直接点取消即可
- 然后根据提示点击 next -> next -> 选择主题点击 next -> next -> finish -> finish

### 2.3 许可证设置

6. 安装工具包: Android SDK Command-line Tools

- 如果未打开软件则打开 android-studio: 执行 android-studio/bin/studio.sh
- 选择: configure/SDK Manager/SDK Tools
- 勾选: Android SDK Command-line Tools 并点击 ok 后按照提示进行下载

7. 设置许可证

```sh
flutter doctor --android-licenses
```

### 2.4 验证

- 如图: Android toolchain 如果是打钩的状态则表示配置成功

```sh
flutter doctor

Doctor summary (to see all details, run flutter doctor -v):
[✓] Flutter (Channel stable, v1.12.13+hotfix.9, on Linux, locale zh_CN.UTF-8)
[✓] Android toolchain - develop for Android devices (Android SDK version 29.0.3)
[!] Android Studio (version 3.6)
    ✗ Flutter plugin not installed; this adds Flutter specific functionality.
    ✗ Dart plugin not installed; this adds Dart specific functionality.
[!] VS Code (version 1.43.2)
    ✗ Flutter extension not installed; install from
      https://marketplace.visualstudio.com/items?itemName=Dart-Code.flutter
[!] Connected device
    ! No devices available

! Doctor found issues in 3 categories.
```

## 三、 卸载环境 android-studio

- 删除 Flutter 文件夹
- 删除 android-studio 文件夹
- 如果存在 sdk 目录则删除该目录
- 删除 ~/.AndroidStudio*/, 其中 * 表示版本号
- 删除 ~/.android/
- 删除启动图标 `jetbrains-studio.desktop` 可能存在位置: `/usr/share/applications` `/usr/local/share/applications`
- 删除 `.zshrc` 或者 `.bashrc` 中添加的内容
